@inherits ContractFormComponent

<PageTitle>@Operation Contrato</PageTitle>

@if (IsBusy)
{
    <SkeletonWave />
}
else
{
    <MudPaper Class="pa-8" Elevation="4">
        <EditForm Model="InputModel" OnValidSubmit="OnValidSubmitAsync" @key="EditFormKey">
            <ObjectGraphDataAnnotationsValidator/>

            <MudText Class="mt-5 mb-3" Typo="Typo.h6">Informações do contrato</MudText>

            <MudDatePicker Class="mb-2"
                           Label="Data de emissão"
                           @bind-Date="@InputModel.IssueDate"
                           For="@(() => InputModel.IssueDate)" />

            <MudDatePicker Class="mb-2"
                           Label="Data de vigência"
                           @bind-Date="InputModel.EffectiveDate"
                           For="@(() => InputModel.EffectiveDate)" />

            <MudDatePicker Class="mb-2"
                           Label="Data de término"
                           @bind-Date="InputModel.TermEndDate"
                           For="@(() => InputModel.TermEndDate)" />

            <MudDatePicker Class="mb-2"
                           Label="Data da assinatura"
                           @bind-Date="InputModel.SignatureDate"
                           For="@(() => InputModel.SignatureDate)" />

            <MudTextField Class="mb-2"
                          ReadOnly="true"
                          Label="@(InputModel.OfferId == 0 ? "Clique aqui para pesquisar a proposta" : "Proposta selecionada")"
                          AdornmentIcon="@Icons.Material.Filled.Search"
                          @onclick="@OpenOfferDialog"
                          OnAdornmentClick="OpenOfferDialog"
                          Adornment="Adornment.End"
                          Value="@InputModel.Offer?.Property?.Title" />

            <MudTextField Class="mb-2"
                          ReadOnly="true"
                          Label="@(InputModel.Offer?.BuyerId == 0 ? "Clique aqui para pesquisar o comprador" : "Comprador selecionado")"
                          AdornmentIcon="@Icons.Material.Filled.PersonSearch"
                          @onclick="@OpenBuyerDialog"
                          OnAdornmentClick="OpenBuyerDialog"
                          Adornment="Adornment.End"
                          Value="@InputModel.Offer?.Buyer?.Name" />
            
            <MudTextField Class="mb-2"
                          ReadOnly="true"
                          Label="@(InputModel.Offer?.Property?.SellerId == 0 ? "Clique aqui para pesquisar o vendedor" : "Vendedor selecionado")"
                          AdornmentIcon="@Icons.Material.Filled.PersonSearch"
                          @onclick="@OpenSellerDialog"
                          OnAdornmentClick="OpenSellerDialog"
                          Adornment="Adornment.End"
                          Value="@InputModel.Offer?.Property?.Seller?.Name" />

            <MudTextField Class="mb-2"
                          ReadOnly="true"
                          Label="@(InputModel.Offer?.PropertyId == 0 ? "Clique aqui para pesquisar o imóvel" : "Imóvel selecionado")"
                          AdornmentIcon="@Icons.Material.Filled.Search"
                          @onclick="@OpenPropertyDialog"
                          OnAdornmentClick="OpenPropertyDialog"
                          Adornment="Adornment.End"
                          Value="@InputModel.Offer?.Property?.Title" />

            <MudButton ButtonType="ButtonType.Submit"
                       Variant="Variant.Filled"
                       Color="Color.Primary"
                       Class="mt-6"
                       StartIcon="@(ContractId == 0 ? Icons.Material.Filled.Send : Icons.Material.Filled.Save)">
                @Operation
            </MudButton>
        </EditForm>
    </MudPaper>
}