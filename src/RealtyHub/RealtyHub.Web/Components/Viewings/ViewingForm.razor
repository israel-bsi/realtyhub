@inherits ViewingFormComponent

<PageTitle>@Operation Visita</PageTitle>

<MudText Typo="Typo.h4">@Operation Visita</MudText>

@if (IsBusy)
{
    <MudPaper Class="pa-8 mt-4">
        <MudSkeleton Animation="Animation.Wave" Height="55px" />
        <MudSkeleton Animation="Animation.Wave" Height="110px" />
        <MudSkeleton Animation="Animation.Wave" Height="55px" />
        <MudSkeleton Animation="Animation.Wave" Height="110px" />
        <MudSkeleton Animation="Animation.Wave" Height="55px" />
    </MudPaper>
}
else
{
    <MudPaper Class="pa-8 mt-4" Elevation="2">
        <EditForm OnValidSubmit="OnValidSubmitAsync" Model="InputModel">
            <ObjectGraphDataAnnotationsValidator />
            
            <MudDatePicker Label="Data da Visita" 
                           @bind-Date="@InputModel.ViewingDate"/>
            
            <MudTimePicker Label="Hora da Visita"
                           @bind-Time="@ViewingTime"/>

            @if (Id != 0)
            {
                <EnumSelect TEnum="EViewingStatus"
                            Label="Status da Visita"
                            @bind-SelectedValue="InputModel.ViewingStatus"/>
            }
            
            <MudTextField T="long" 
                          Label="Imóvel" 
                          @bind-Value="InputModel.PropertyId"
                          For="@(() => InputModel.PropertyId)" 
                          InputType="InputType.Number"/>

            <MudTextField T="long"
                          Label="Cliente"
                          @bind-Value="InputModel.CustomerId"
                          For="@(() => InputModel.CustomerId)"
                          InputType="InputType.Number" />
            
            <div>
                <MudButton ButtonType="ButtonType.Submit"
                           Variant="Variant.Filled"
                           Color="Color.Primary"
                           Class="mt-6"
                           StartIcon="@Icons.Material.Filled.Save">
                    @Operation
                </MudButton>
                @if (Id != 0)
                {
                    <MudButton Variant="Variant.Filled"
                               Color="Color.Primary"
                               Class="mt-6 ml-2"
                               StartIcon="@Icons.Material.Filled.Check"
                               OnClick="OnClickDoneViewing">
                        Finalizar Visita
                    </MudButton>
                    <MudButton Variant="Variant.Filled"
                               Color="Color.Error"
                               Class="mt-6 ml-2"
                               StartIcon="@Icons.Material.Filled.Cancel"
                               OnClick="OnClickCancelViewing">
                        Cancelar Visita
                    </MudButton>
                }
            </div>
        </EditForm>
    </MudPaper>
}